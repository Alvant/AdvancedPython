# Lab 9. Into the Async

[–î–µ–º–æ –Ω–æ—É—Ç–±—É–∫](./demo/Coroutines-Into-the-Async.ipynb) –ø—Ä–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å.

–í –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞–¥–∞–Ω–∏—è –Ω–∞–¥–æ —Ä–µ—à–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –¥–≤–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –∏–∑ [–ª–∞–±—ã](http://cs.mipt.ru/advanced_python/lessons/lab09.html).
–ù–æ –ø–µ—Ä–µ–¥ –∑–∞–¥–∞—á–∫–∞–º–∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è –æ—Ç–≤–ª–µ—á—å—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –Ω–µ–±–æ–ª—å—à–æ–π —Å—é–∂–µ—Ç, –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É—é—â–∏–π –∏–¥–µ—é –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏...


<h2>
  <p align="center">–ú–æ–Ω–µ –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å,<br />
  –∏–ª–∏ –ï—â—ë –æ–¥–∏–Ω –ø—Ä–∏–º–µ—Ä, –ø–æ—è—Å–Ω—è—é—â–∏–π, ¬´–ø—Ä–æ —á—Ç–æ –≤–æ–æ–±—â–µ —ç—Ç–æ –≤—Å—ë¬ª</p>
</h2>

–ò–∑–≤–µ—Å—Ç–Ω–∞ [—Å–µ—Ä–∏—è —Ä–∞–±–æ—Ç](https://ru.wikipedia.org/wiki/%D0%A0%D1%83%D0%B0%D0%BD%D1%81%D0%BA%D0%B8%D0%B9_%D1%81%D0%BE%D0%B1%D0%BE%D1%80_(%D1%81%D0%B5%D1%80%D0%B8%D1%8F_%D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD)) –ö–ª–æ–¥–∞ –ú–æ–Ω–µ,
—Å–æ—Å—Ç–æ—è—â–∞—è –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–µ—Å—è—Ç–∫–æ–≤ –∫–∞—Ä—Ç–∏–Ω, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö —Ö—É–¥–æ–∂–Ω–∏–∫ –∏–∑–æ–±—Ä–∞–∑–∏–ª –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –†—É–∞–Ω—Å–∫–∏–π —Å–æ–±–æ—Ä,
—Å –ø—Ä–∏–º–µ—Ä–Ω–æ –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ —Ä–∞–∫—É—Ä—Å–∞.
–ù–æ –≤ —Ä–∞–∑–Ω–æ–µ –≤—Ä–µ–º—è —Å—É—Ç–æ–∫ –∏ –≤ —Ä–∞–∑–Ω—É—é –ø–æ–≥–æ–¥—É.
–ù–∞–ø—Ä–∏–º–µ—Ä, –æ–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –≤–µ—á–µ—Ä–Ω–µ–≥–æ –†—É–∞–Ω—Å–∫–æ–≥–æ —Å–æ–±–æ—Ä–∞ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –≤ –ü—É—à–∫–∏–Ω—Å–∫–æ–º –º—É–∑–µ–µ:

<p align="center">
  <a href="https://commons.wikimedia.org/wiki/File:Claude_Monet_-_The_Rouen_Cathedral_at_Sunset_-_Pushkin_museum.jpg?uselang=ru">
    <img src="https://raw.githubusercontent.com/Alvant/AdvancedPython/master2021/labs/lab09/_rouen/images/256px/Claude_Monet_-_The_Rouen_Cathedral_at_Sunset_-_Pushkin_museum.jpg" alt="The Rouen Cathedral at Sunset ‚Äî Pushkin museum" />
  </a>
</p>
<p align="center">
  <em>¬´–†—É–∞–Ω—Å–∫–∏–π —Å–æ–±–æ—Ä –≤–µ—á–µ—Ä–æ–º¬ª (Le Cath√©drale de Rouen). –ù–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ü—É—à–∫–∏–Ω—Å–∫–æ–º –º—É–∑–µ–µ (–ú–æ—Å–∫–≤–∞).</em>
</p>

–ù–∞–º –∂–µ –±—É–¥–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞ —ç—Ç–∞ —Å–µ—Ä–∏—è —Ä–∞–±–æ—Ç –ö–ª–æ–¥–∞ –ú–æ–Ω–µ –Ω–µ —Å —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π, –∞ —Å... "–≤—Ä–µ–º—è–∑–∞—Ç—Ä–∞—Ç–Ω–æ–π" —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è.
–ö–∞–∫ –º–æ–≥ –±—ã –ø–æ—Å—Ç—É–ø–∏—Ç—å –ú–æ–Ω–µ, –µ—Å–ª–∏ –µ–º—É —Ö–æ—Ç–µ–ª–æ—Å—å –∏–∑–æ–±—Ä–∞–∑–∏—Ç—å —Å–æ–±–æ—Ä –≤ —Ä–∞–∑–Ω–æ–µ –≤—Ä–µ–º—è —Å—É—Ç–æ–∫?

–ü–µ—Ä–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî "—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π"[^sync].
–≠—Ç–æ –∫–∞–∫ –µ—Å–ª–∏ –±—ã –ú–æ–Ω–µ –Ω–µ –ø—Ä–∏—Å—Ç—É–ø–∞–ª –∫ –Ω–æ–≤–æ–π –∫–∞—Ä—Ç–∏–Ω–µ, –ø–æ–∫–∞ –Ω–µ –∑–∞–∫–æ–Ω—á–∏—Ç —É–∂–µ –Ω–∞—á–∞—Ç—É—é.
–ù–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –ú–æ–Ω–µ –≤—ë–ª –±—ã —Ä–∞–±–æ—Ç—É –Ω–∞–¥ –∫–∞—Ä—Ç–∏–Ω–æ–π, –∏–∑–æ–±—Ä–∞–∂–∞—é—â–µ–π —Å–æ–±–æ—Ä —É—Ç—Ä–æ–º.
–ê –¥–Ω—ë–º –∏ –≤–µ—á–µ—Ä–æ–º –±—ã –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–ª.
–ó–∞–≤–µ—Ä—à–∏–≤ "—É—Ç—Ä–µ–Ω–Ω–∏–π —Å–æ–±–æ—Ä", –ú–æ–Ω–µ –±—ã –ø—Ä–∏—Å—Ç—É–ø–∏–ª, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫ "—Å–æ–±–æ—Ä—É –¥–Ω—ë–º".
–ò –æ–ø—è—Ç—å: –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π —Ä–∞–±–æ—Ç–∞ –≤–µ–ª–∞—Å—å –±—ã —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ –≤—Ä–µ–º—è —Å—É—Ç–æ–∫, –∞ –æ—Å—Ç–∞–ª—å–Ω–æ–µ –±—ã –≤—Ä–µ–º—è –ú–æ–Ω–µ "–±–µ—Å–ø–æ–ª–µ–∑–Ω–æ –ø—Ä–æ—Å—Ç–∞–∏–≤–∞–ª".
–ü–æ—Å–ª–µ "—Å–æ–±–æ—Ä–∞ –¥–Ω—ë–º" —Ö—É–¥–æ–∂–Ω–∏–∫ –±—ã –ø—Ä–∏—Å—Ç—É–ø–∏–ª –∫ "–≤–µ—á–µ—Ä–Ω–µ–º—É —Å–æ–±–æ—Ä—É", –∏ —Ä–∏—Å–æ–≤–∞–ª –±—ã —Ç–æ–ª—å–∫–æ –ø–æ –≤–µ—á–µ—Ä–∞–º.

–ù–æ –ú–æ–Ω–µ –º–æ–≥ –±—ã –ø–æ—Å—Ç—É–ø–∏—Ç—å –∏–Ω–∞—á–µ, "–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ".
–£—Ç—Ä–æ–º –ú–æ–Ω–µ —Ä–∏—Å–æ–≤–∞–ª –±—ã –æ–¥–Ω—É –∫–∞—Ä—Ç–∏–Ω—É, –¥–Ω—ë–º&nbsp;‚Äî&nbsp;–¥—Ä—É–≥—É—é, –∞ –≤–µ—á–µ—Ä–æ–º&nbsp;‚Äî&nbsp;—Ç—Ä–µ—Ç—å—é.
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Ö—É–¥–æ–∂–Ω–∏–∫ –±—ã–ª –±—ã –∑–∞–Ω—è—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ –≤—Å–µ–≥–æ –¥–Ω—è.
–ü—Ä–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º –ø–æ–¥—Ö–æ–¥–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞—Ä—Ç–∏–Ω –º–æ–≥–ª–∏ –±—ã –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ "–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏" –≤ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –≤—Ä–µ–º—è.
(–¢–∞–∫ –ú–æ–Ω–µ –∏ —Ä–∞–±–æ—Ç–∞–ª –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ: "–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, –Ω–æ –Ω–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ" –Ω–∞–¥ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–∞—Ä—Ç–∏–Ω–∞–º–∏[^monet].)

–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤: —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ ‚Äî –ø—Ä–∏–≤–µ–¥–µ–Ω–æ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ –Ω–∏–∂–µ.
–û—á–µ–≤–∏–¥–Ω–æ, –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –ø–æ–∑–≤–æ–ª–∏—Ç —Å–¥–µ–ª–∞—Ç—å —Ç—É –∂–µ —Ä–∞–±–æ—Ç—É (—Ç—Ä–∏ –∫–∞—Ä—Ç–∏–Ω—ã —Å–æ–±–æ—Ä–∞) –∑–∞ –º–µ–Ω—å—à–µ–µ –≤—Ä–µ–º—è.

<p align="center">
  <a href="https://media.giphy.com/media/bZADBEMYl3AiNlYngs/giphy.gif">
    <img src="https://camo.githubusercontent.com/b62a3047edd43d526b75b67fcd09c13f2cbccf4a57db4260c3a3b3770d2c47ab/68747470733a2f2f6d656469612e67697068792e636f6d2f6d656469612f625a414442454d596c3341694e6c596e67732f67697068792e676966" alt="Rouen Cathedral: Sync Vs. Async" title="Lalala. Part 3" data-canonical-src="https://media.giphy.com/media/bZADBEMYl3AiNlYngs/giphy.gif" />
  </a>
</p>
<p align="center">
  <em>
    –†—É–∞–Ω—Å–∫–∏–π —Å–æ–±–æ—Ä —É—Ç—Ä–æ–º, –¥–Ω—ë–º –∏ –≤–µ—á–µ—Ä–æ–º: –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π (–≤–µ—Ä—Ö–Ω—è—è –ø–æ–ª–æ–≤–∏–Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏) –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π (–Ω–∏–∂–Ω—è—è –ø–æ–ª–æ–≤–∏–Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏) —Ä–∞–±–æ—Ç—ã –Ω–∞–¥ –∫–∞—Ä—Ç–∏–Ω–∞–º–∏.
    –í —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —Ö—É–¥–æ–∂–Ω–∏–∫ —Ä–∏—Å—É–µ—Ç –∫–∞—Ä—Ç–∏–Ω—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –æ–¥–Ω—É –∑–∞ –¥—Ä—É–≥–æ–π.
	–ù–µ –ø—Ä–∏—Å—Ç—É–ø–∞–µ—Ç –∫ –Ω–æ–≤–æ–π, –ø–æ–∫–∞ –Ω–µ –∑–∞–≤–µ—Ä—à–∏—Ç –Ω–∞—á–∞—Ç—É—é.
	–í –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º&nbsp;‚Äî&nbsp;–≤ —Ç–µ—á–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –¥–Ω—è —Ö—É–¥–æ–∂–Ω–∏–∫ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–∞—Ä—Ç–∏–Ω–∞–º–∏.
  </em>
</p>



## –ó–∞–¥–∞—á–∞ 1 (–æ–Ω–∞ –∂–µ –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 4)

–û—Ç –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç –¥–∞–Ω–Ω—ã–µ.
–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Å–æ–ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è –≤—ã—á–∏—Å–ª—è–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ, –¥–∏—Å–ø–µ—Ä—Å–∏—é, –∞ —Ç–∞–∫–∂–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã —Å–æ–ø—Ä–æ–≥—Ä–∞–º–º–∞ –¥–æ–ª–∂–Ω–∞ –≤—ã–¥–∞–≤–∞—Ç—å –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Å–∏–≥–Ω–∞–ª–æ–≤.


## –ó–∞–¥–∞—á–∞ 2 (–æ–Ω–∞ –∂–µ –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 5)

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ —É –≤–∞—Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–æ–º, –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–∏—Ö–æ–¥—è—Ç –ø–∞–∫–µ—Ç—ã, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.
–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∂–¥–æ–≥–æ –∏–∑ –∫–ª–∏–µ–Ω—Ç–æ–≤ –¥–æ–ª–∂–Ω–∞ –∏–¥—Ç–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ.

–ß—Ç–æ –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:

1. –ö–æ—Ä—É—Ç–∏–Ω–∞ `connect_user` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –∏ —Å–æ–∑–¥–∞–µ—Ç –Ω–∞ –µ–≥–æ –æ—Å–Ω–æ–≤–µ –∫–æ—Ä—É—Ç–∏–Ω—É `write_to_file`.
2. –ö–æ—Ä—É—Ç–∏–Ω–∞ `write_to_file(file)` –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–º –∑–∞–¥–∞—á —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —Ñ–∞–π–ª–æ–≤—ã–π –æ–±—ä–µ–∫—Ç, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏. –¢–∞–∫–∂–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–∏–≥–Ω–∞–ª –æ–± –æ–∫–æ–Ω—á–∞–Ω–∏–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏ –≤—ã—Ö–æ–¥–∏—Ç –∏–∑ —Å–æ–ø—Ä–æ–≥—Ä–∞–º–º—ã.
3. –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—â–∏–π –∑–∞–¥–∞—á–∏ –ø–æ —Å–æ–ø—Ä–æ—Ü–µ—Å—Å–∞–º –Ω–∞ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

```python
import random


def user_connection(username: str):
    for i in range(random.randint(10, 20)):
        yield f"{username} message{i}"


def establish_connection(auth: bool = True):
    id = f"{random.randint(0,100000000):010}"

    if auth:
        yield f"auth {id}"

    yield from user_connection(id)

    if auth:
        yield f"disconnect {id}"
```

–ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–∏—Ö–æ–¥—è—â–∏—Ö –æ—Ç –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```bash
>>> for i in establish_connection():
...     print(i)
auth 0081575115
0081575115 message0
0081575115 message1
0081575115 message2
0081575115 message3
0081575115 message4
0081575115 message5
0081575115 message6
disconnect 0081575115
```

–ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–∏—Ö–æ–¥—è—â–∏—Ö –æ—Ç –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```bash
>>> for i in establish_connection(False):
...     print(i)
0015354373 message0
0015354373 message1
0015354373 message2
0015354373 message3
0015354373 message4
0015354373 message5
0015354373 message6
0015354373 message7
0015354373 message8
0015354373 message9
0015354373 message10
0015354373 message11
0015354373 message12
```

–î–∞–Ω–Ω—ã–µ –æ—Ç –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∏–ª–∏ —Ä–∞–∑–ª–æ–≥–∏–Ω–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –Ω–µ –¥–æ–ª–∂–Ω—ã.

```python
import random


def connection():
    connections = [establish_connection(True) for i in range(10)]
    connections.append(establish_connection(False))
    connections.append(establish_connection(False))

    while len(connections) > 0:
        connection = random.choice(connections)

        try:
            yield next(connection)
        except StopIteration:
            del connections[connections.index(connection)]
```

–ü—Ä–∏–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞–¥–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å, –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å, –≤—ã–ø–æ–ª–Ω–∏–≤ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥:

```python
for i in connection():
    print(i)
```


## –ó–∞–¥–∞—á–∞ 3* (¬´‚ÄéChamomile Divination 3¬ª‚Äé)

* [–ß–∞—Å—Ç—å 2](https://github.com/Alvant/AdvancedPython/blob/master2022/labs/lab08/README.md#%D0%B7%D0%B0%D0%B4%D0%B0%D1%87%D0%B0-8-chamomile-divination-2)
* [–ß–∞—Å—Ç—å 1](https://github.com/Alvant/AdvancedPython/tree/master2022/labs/lab04#%D0%B7%D0%B0%D0%B4%D0%B0%D1%87%D0%B0-2-chamomile-divination)

<p>
<em>
  –û–ø—è—Ç—å –Ω–∏—á–µ–≥–æ.
  –†–æ–º–∞—à–∫–∏...
  –ó–∞—á–µ–º —è —ç—Ç–æ –Ω–∞—á–∞–ª–∞, –µ—Å–ª–∏ –∑–Ω–∞–ª–∞, —á—Ç–æ —Å–Ω–æ–≤–∞ –Ω–∏—á–µ–≥–æ –Ω–µ –≤—ã–π–¥–µ—Ç?
  –ó–∞—á–µ–º —Ä–∞–∑–æ–∂–≥–ª–∞ –Ω–∞–¥–µ–∂–¥—É, –∫–æ—Ç–æ—Ä–æ–π —Å–Ω–æ–≤–∞ —Å—É–∂–¥–µ–Ω–æ –±—ã–ª–æ —É–≥–∞—Å–Ω—É—Ç—å?
  –ú–µ–¥–ª–µ–Ω–Ω–æ –∏ –±–æ–ª—å–Ω–æ —É–≥–∞—Å–Ω—É—Ç—å.
  –ê –ø–æ–∫–∞ —Å–Ω–æ–≤–∞ –±–æ–ª–∏—Ç, –≤—Å—ë –µ—â—ë –±–æ–ª–∏—Ç, –±–æ–ª–∏—Ç –≥–¥–µ-—Ç–æ –≤ —Å–µ—Ä–¥—Ü–µ.
  –†–∞–∑—Ä—ã–≤–∞–µ—Ç.
  –ó–∞—á–µ–º?
  –†–æ–º–∞—à–∫–∏...
  –•–æ—Ç—è –µ—Å–ª–∏ –µ—â—ë –º–æ–∂–µ—Ç –±–æ–ª–µ—Ç—å, –∑–Ω–∞—á–∏—Ç, –Ω–µ –≤—Å—ë –ø–æ—Ç–µ—Ä—è–Ω–æ.
  –í—Å—ë-—Ç–∞–∫–∏ –ª—É—á—à–µ, —á—Ç–æ–± –∏–Ω–æ–≥–¥–∞ —Ä–∞–∑—Ä—ã–≤–∞–ª–æ, —á–µ–º —É–≥–∞—Å–Ω—É—Ç—å –æ–¥–∏–Ω —Ä–∞–∑... –∏ –Ω–∞–≤—Å–µ–≥–¥–∞.
</em>
</p>

–ù–∞—Ç–∞—à–∞ –ø–æ–Ω—è–ª–∞, —á—Ç–æ, –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, –µ—ë —Å–ø–æ—Å–æ–± –≥–∞–¥–∞–Ω–∏—è –Ω–µ —Ç–∞–∫–æ–π —É–∂ –∏ "–Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π"!
–†–æ–º–∞—à–µ–∫ –±—ã–ª–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ, –¥–∞, –Ω–æ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≥–∞–¥–∞–Ω–∏—è –ø–æ–ª—É—á–∞–ª–æ—Å—å –≤–µ–¥—å —Ç–æ –∂–µ —Å–∞–º–æ–µ, —á—Ç–æ –±—ã–ª–æ –±—ã —Å –æ–¥–Ω–æ–π "–±–æ–ª—å—à–æ–π" —Ä–æ–º–∞—à–∫–æ–π, —Å–æ –≤—Å–µ–º–∏ –ª–µ–ø–µ—Å—Ç–∫–∞–º–∏ –≤—Å–µ—Ö "–æ–±—ã—á–Ω—ã—Ö" —Ä–æ–º–∞—à–µ–∫ ü§≠

–ü–æ—ç—Ç–æ–º—É –ù–∞—Ç–∞—à–∞ –ø—Ä–∏–¥—É–º–∞–ª–∞ –Ω–æ–≤—ã–π —Å–ø–æ—Å–æ–± –≥–∞–¥–∞–Ω–∏—è.
–†–æ–º–∞—à–µ–∫ —Å–Ω–æ–≤–∞ –±—É–¥–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ.
–ù–æ —Ç–µ–ø–µ—Ä—å –ª–µ–ø–µ—Å—Ç–∫–∏ –Ω–∞–¥–æ –æ–±—Ä—ã–≤–∞—Ç—å *–æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ, –Ω–æ –Ω–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ* (*–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ*) —Å–æ –≤—Å–µ—Ö —Ä–æ–º–∞—à–µ–∫ —Å—Ä–∞–∑—É!

–ü–æ–º–æ–≥–∏—Ç–µ –ù–∞—Ç–∞—à–µ!
–Ω–∞–ø–∏—à–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, *—Å –ø–æ–º–æ—â—å—é –∫–æ—Ä—É—Ç–∏–Ω*, –æ–±—Ä—ã–≤–∞–µ—Ç —Ä–æ–º–∞—à–∫–∏.
–ù–∞ –≤—Ö–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º–µ, –∫–∞–∫ –æ–±—ã—á–Ω–æ, –ø–æ–¥–∞—ë—Ç—Å—è —Å–ø–∏—Å–æ–∫ —á–∏—Å–µ–ª –ª–µ–ø–µ—Å—Ç–∫–æ–≤ –Ω–∞ —Ä–æ–º–∞—à–∫–∞—Ö –ù–∞—Ç–∞—à–∏ `petal_numbers` –∏ —Å–ª–æ–≤–æ ‚Äì –Ω–∞—á–∞–ª–æ –≥–∞–¥–∞–Ω–∏—è `divination_start`.
–° —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Å–ª–æ–≤–∞ `divination_start` –Ω–∞—á–∏–Ω–∞—é—Ç –æ–±—Ä—ã–≤–∞—Ç—å—Å—è –ª–µ–ø–µ—Å—Ç–∫–∏ –∫–∞–∂–¥–æ–π —Ä–æ–º–∞—à–∫–∏.
–í –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ (*–ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–µ –∑–∞–¥–∞—á*, –∏–ª–∏ *–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–µ*[^scheduler]) –¥–æ–ª–∂–µ–Ω –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —Ü–∏–∫–ª.
–ù–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ —Ü–∏–∫–ª–∞ *—Å–ª—É—á–∞–π–Ω–æ* –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –æ–¥–Ω–∞ –∏–∑ –ù–∞—Ç–∞—à–∏–Ω—ã—Ö —Ä–æ–º–∞—à–µ–∫ –∏ –Ω–∞ –Ω–µ–π —Å –ø–æ–º–æ—â—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –∫–æ—Ä—É—Ç–∏–Ω—ã –æ–±—Ä—ã–≤–∞–µ—Ç—Å—è –ª–µ–ø–µ—Å—Ç–æ–∫.
–ö–∞–∫ —Ç–æ–ª—å–∫–æ *–æ–¥–Ω–∞ –∏–∑ —Ä–æ–º–∞—à–µ–∫* –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ (—Ç–æ –µ—Å—Ç—å –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º –ª–µ–ø–µ—Å—Ç–∫–µ) —Å–∫–∞–∂–µ—Ç "–ª—é–±–∏—Ç", *–≤–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è*: –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ *–ø–æ—Å—ã–ª–∞–µ—Ç —Å–∏–≥–Ω–∞–ª—ã –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏* –≤—Å–µ–º –Ω–µ–æ–∫–æ–Ω—á–µ–Ω–Ω—ã–º —Ä–æ–º–∞—à–∫–∞–º, —Å–∞–º –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (—Ü–∏–∫–ª) –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è, –∏ –ù–∞—Ç–∞—à–∞ –ø–æ–ª—É—á–∞–µ—Ç —Å–≤–æ—ë –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ ("–ª—é–±–∏—Ç", –µ—Å–ª–∏ –Ω–∞—à–ª–∞—Å—å –æ–ø–∏—Å–∞–Ω–Ω–∞—è —Ä–æ–º–∞—à–∫–∞ —Å –æ—Ç–≤–µ—Ç–æ–º "–ª—é–±–∏—Ç"; –∏–Ω–∞—á–µ, –µ—Å–ª–∏ –ø–æ—Å–ª–µ –æ–±—Ä—ã–≤–∞–Ω–∏—è —É–∂–µ –≤—Å–µ—Ö —Ä–æ–º–∞—à–µ–∫ –≤—Å—ë —Ä–∞–≤–Ω–æ –æ—Ç–≤–µ—Ç "–Ω–µ –ª—é–±–∏—Ç", —Ç–æ "–Ω–µ –ª—é–±–∏—Ç").

*–ü—Å–µ–≤–¥–æ–∫–æ–¥* (—Å–∫–æ—Ä–µ–µ, —Ç–µ–Ω—å —Å–∫–µ–ª–µ—Ç–∞ –ø—Ä–∏–∑—Ä–∞–∫–∞) –æ–ø–∏—Å–∞–Ω–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –¥–ª—è –ù–∞—Ç–∞—à–∏:
```
petal_numbers <- INPUT
divination_start <- INPUT

chamomile_coroutines <- create_coroutines(petal_numbers, divination_start)

WHILE (–µ—Å—Ç—å –ª–µ–ø–µ—Å—Ç–æ–∫ —Ö–æ—Ç—è –±—ã –Ω–∞ –æ–¥–Ω–æ–π —Ä–æ–º–∞—à–∫–µ AND –Ω–µ –Ω–∞—à–ª–∞—Å—å —Ä–æ–º–∞—à–∫–∞ —Å –∏—Ç–æ–≥–æ–º "–ª—é–±–∏—Ç"):
    chamomile <- random_choice(chamomile_coroutines)
    pluck_petal(chamomile)

FOR (chamomile IN chamomile_coroutines):
    send_finish_if_needed(chamomile)

RETURN prediction
```


## –°—Å—ã–ª–∫–∏

* [–°—Ç–∞—Ç—å—è –ø—Ä–æ —Å–µ—Ä–∏—é ¬´–†—É–∞–Ω—Å–∫–∏–π —Å–æ–±–æ—Ä¬ª](https://marinagra.livejournal.com/151423.html)


[^sync]: –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –Ω–µ –∫–∞–∫ "—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –ø–ª–∞–≤–∞–Ω–∏–µ", –∞ –≤ "–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—Å–∫–æ–º" —Å–º—ã—Å–ª–µ.
–û–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–µ–π—Å—Ç–≤–∏–π –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å—Ç—Ä–æ–≥–æ –æ–¥–Ω–æ –∑–∞ –¥—Ä—É–≥–∏–º (–∑–∞–∫–æ–Ω—á–∏–ª —Ä–∏—Å–æ–≤–∞—Ç—å –æ–¥–Ω—É –∫–∞—Ä—Ç–∏–Ω—É, –ø—Ä–∏—Å—Ç—É–ø–∏–ª –∫ –¥—Ä—É–≥–æ–π).
–ö–æ—Ä–æ—Ç–∫–æ –∏ –¥–æ—Å—Ç—É–ø–Ω–æ –ø—Ä–æ –∑–Ω–∞—á–µ–Ω–∏—è —Å–ª–æ–≤ "—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π" –∏ "–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π" —Ä–∞—Å—Å–∫–∞–∑–∞–Ω–æ [—Ç—É—Ç](https://stackoverflow.com/questions/748175/asynchronous-vs-synchronous-execution-what-is-the-main-difference#comment57854159_748189).

[^monet]: [–í—ã–¥–µ—Ä–∂–∫–∞](https://ru.wikipedia.org/wiki/%D0%A0%D1%83%D0%B0%D0%BD%D1%81%D0%BA%D0%B8%D0%B9_%D1%81%D0%BE%D0%B1%D0%BE%D1%80_(%D1%81%D0%B5%D1%80%D0%B8%D1%8F_%D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD)#cite_ref-_aa50bf46a673f9c4_8-0) –∏–∑ –í–∏–∫–∏–ø–µ–¥–∏–∏ (–≥–¥–µ, –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å, —Å—Å—ã–ª–∞—é—Ç—Å—è –µ—â—ë –Ω–∞ –¥—Ä—É–≥–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫): "–î–∞–Ω–∏—ç–ª—å –í–∏–ª—å–¥–µ–Ω—à—Ç–µ–π–Ω —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤—É–µ—Ç, —á—Ç–æ –ú–æ–Ω–µ —Ä–∞–±–æ—Ç–∞–ª –Ω–∞–¥ 9-14 –ø–æ–ª–æ—Ç–Ω–∞–º–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ."

[^scheduler]: –í–æ–æ–±—â–µ –ø–æ–Ω—è—Ç–∏–µ "–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä" –æ–±—ã—á–Ω–æ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ [–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö —Å–∏—Å—Ç–µ–º](https://en.wikipedia.org/wiki/Orchestration_(computing)). –ù–æ –º–æ–∂–Ω–æ –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ –±–æ–ª–µ–µ –æ–±—â–æ, –æ–ø–∏—Å—ã–≤–∞—è "—Å—É—â–Ω–æ—Å—Ç—å", –∫–æ—Ç–æ—Ä–∞—è —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–∞–±–æ—Ç–æ–π –¥—Ä—É–≥–∏—Ö "—Å—É—â–Ω–æ—Å—Ç–µ–π". –î–ª—è –ø–æ–Ω—è—Ç–∏—è –∂–µ "–ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á" –≤–∞–∂–Ω–æ –±—ã –±—ã–ª–æ –µ—â—ë –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–∞–º–æ –ø–æ–Ω—è—Ç–∏–µ "–∑–∞–¥–∞—á–∞". –ü–æ—ç—Ç–æ–º—É –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –æ–ø–∏—Å–∞–Ω–Ω–æ–π –ø–æ –ª–∞–±–µ –∑–∞–¥–∞—á–∏ —Ç–µ—Ä–º–∏–Ω—ã "–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä" –∏ "–ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á" —Å—Ç–æ–∏—Ç —Å—á–∏—Ç–∞—Ç—å –Ω–µ "—Å—Ç—Ä–æ–≥–∏–º–∏", –Ω–æ "–ø–µ—Ä–µ–¥–∞—é—â–∏–º–∏ —Å—É—Ç—å".
